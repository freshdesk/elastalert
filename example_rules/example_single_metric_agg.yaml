name: Metricbeat CPU Spike Rule
type: metric_aggregation

#es_host: localhost
#es_port: 9200

index: sperlock.span

buffer_time:
  minutes: 30

metric_agg_key: duration
metric_agg_type: avg
query_key: serviceName
doc_type: metricsets
  
  
# sync_bucket_interval: true
# allow_buffer_time_overlap: true
#use_run_every_query_size: true

min_threshold: 1000
max_threshold: 20000

filter:
- query:
    query_string:
      query: "serviceName: search-service"
    

# (Required)
# The alert is use when a match is found
alert:
- "debug"

