name: Metricbeat CPU Spike Rule
type: metric_aggregation

es_host: localhost
es_port: 9200

# index: traces
index: logstash*

buffer_time:
  days: 1

metric_agg_key: response
metric_agg_type: count
query_key: agent
doc_type: _doc

# timestamp_field: "@timestamp"

  
  
# sync_bucket_interval: true
# allow_buffer_time_overlap: true
#use_run_every_query_size: true

min_threshold: 1000
max_threshold: 20000

filter:
- query:
    query_string:
      query: "response: '200'"
    

# (Required)
# The alert is use when a match is found
alert:
- "debug"

